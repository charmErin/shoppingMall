<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="Order">
    <select id="findById" parameterType="java.util.List" resultMap="cart">
        select c.memberId, c.goodsId, c.cartStock, g.id, g.goodsFileName1 ,g.goodsName, g.goodsStock, g.goodsPrice, g.goodsDiscount from chick_cart c, chick_goods g
        where c.goodsId = g.id and g.id in
        <foreach collection="list" item="id" separator="," index="idx" open="(" close=")">
            #{id}
        </foreach>
        order by id desc
    </select>

    <resultMap type="goods" id="goodsDTO">
        <result column="id" property="id"/>
        <result column="goodsName" property="goodsName"/>
        <result column="goodsStock" property="goodsStock"/>
        <result column="goodsPrice" property="goodsPrice"/>
        <result column="goodsDiscount" property="goodsDiscount"/>
        <result column="goodsFileName1" property="goodsFileName1"/>
    </resultMap>

    <resultMap type="cart" id="cart">
        <result column="goodsId" property="goodsId"/>
        <result column="memberId" property="memberId"/>
        <result column="cartStock" property="cartStock"/>
        <collection property="goodsDTO" resultMap="goodsDTO"/>
    </resultMap>

    <insert id="save" parameterType="orderPage">
        insert into chick_orderPage (memberId, orderName, orderZipCode, orderAddress, orderAddDetail ,orderMobile, deliveryMsg)
            values (#{memberId}, #{orderName}, #{orderZipCode}, #{orderAddress}, #{orderAddDetail}, #{orderMobile}, #{deliveryMsg})
    </insert>

    <select id="findAll" parameterType="String" resultType="orderPage">
        select * from chick_orderpage where memberId=#{memberId} order by id desc
    </select>
</mapper>